WebFontConfig={google:{families:["VT323"]},active:function(){start()}},function(){var a=document.createElement("script");a.src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.10/webfont.js",a.async="true",document.head.appendChild(a)}();var PongGame=function(a){var b=this,c=a;window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;var d={},e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=!1,m=c.level||1,n=c.theme||null,o=c.background||"#000000",p=c.field||{background:"#000000",color:"#FFFFFF"},q=c.paddle||{width:50,height:10,color:"#FFFFFF"},r=c.ball||{radius:5,color:"#FFFFFF"},s=c.width||window.innerWidth,t=c.height||window.innerHeight;switch(m<1&&(m=1),m>5&&(m=5),n){case"light":o="#EEEEEE",p.background="#EEEEEE",p.color="#999999",q.color="#999999",r.color="#999999";break;case"matrix":o="#111111",p.background="#111111",p.color="#00FF00",q.color="#00FF00",r.color="#00FF00";break;case"dark":o="#000000",p.background="#000000",p.color="#FFFFFF",_paddle.color="#FFFFFF",j.color="#FFFFFF"}this.init=function(){b.init()},b.init=function(){e=document.createElement("canvas"),e.width=s,e.height=t,f=e.getContext("2d"),window.onload=b.initGame},b.initGame=function(){document.body.appendChild(e),g=new Field,h=new Player,i=new Computer,j=new Ball(g.x+.5*g.width,.5*g.height),k=new Interface,b.startGame()},b.startGame=function(){l&&b.update(),k.controls(),b.render(),window.requestAnimationFrame(b.startGame)},b.playGame=function(){l=!0},b.pauseGame=function(){l=!1},b.openMenu=function(){k.openMenu()},b.update=function(){h.update(),i.update(),j.update(h.paddle,i.paddle)},b.render=function(){f.fillStyle=o,f.fillRect(0,0,s,t),g.render(),h.render(),i.render(),j.render(),k.render()},Interface=function(){f.font="30px VT323"},Interface.prototype.render=function(){this.computerScore=String(i.score),this.playerScore=String(h.score),f.fillText(this.computerScore,10,30),f.fillText(this.playerScore,s-30,t-10),l||(f.textAlign="center",f.fillText("Press ENTER to play",.5*s,.5*t))},Interface.prototype.controls=function(){for(var a in d){var c=Number(a);13!=c||l||b.playGame(),32==c&&l&&b.pauseGame()}},Field=function(){this.background=p.background,this.color=p.color,this.margin=50,this.width=s-2*this.margin,this.height=t-2*this.margin,this.x=.5*s-.5*this.width,this.y=.5*t-.5*this.height},Field.prototype.render=function(){f.fillStyle=this.background,f.fillRect(this.x,this.y,this.width,this.height),f.fillStyle=this.color,f.fillRect(this.x-6,this.y,6,this.height),f.fillRect(this.x+this.width,this.y,6,this.height),f.setLineDash([5,10]),f.beginPath(),f.moveTo(g.x,g.y+.5*g.height-2),f.lineTo(g.x+g.width,g.y+.5*g.height-2),f.strokeStyle=this.color,f.stroke()},Paddle=function(a,b){this.width=q.width,this.height=q.height,this.x=a-.5*this.width,this.y=b-.5*this.height,this.x_speed=0,this.y_speed=0},Paddle.prototype.render=function(){f.fillStyle=q.color,f.fillRect(this.x,this.y,this.width,this.height)},Paddle.prototype.restart=function(){this.x=g.x+.5*g.width-.5*this.width,this.x_speed=0,this.y_speed=0},Paddle.prototype.move=function(a,b){this.x+=a,this.y+=b,this.x_speed=a,this.y_speed=b,this.x<g.x?(this.x=g.x,this.x_speed=0):this.x+this.width>g.x+g.width&&(this.x=g.width+g.x-this.width,this.x_speed=0)},Player=function(){var a=g.x+.5*g.width,b=g.y+g.height;this.score=0,this.speed=m*s/400,this.paddle=new Paddle(a,b)},Player.prototype.render=function(){this.paddle.render()},Player.prototype.update=function(){for(var a in d){var b=Number(a);37==b?this.paddle.move(-this.speed,0):39==b?this.paddle.move(this.speed,0):this.paddle.move(0,0)}},Computer=function(){var a=g.x+.5*g.width,b=g.y;this.score=0,this.speed=m*s/400,this.paddle=new Paddle(a,b)},Computer.prototype.render=function(){this.paddle.render()},Computer.prototype.update=function(){var a=j.x,b=-(this.paddle.x+.5*this.paddle.width-a);b<-this.speed?b=-this.speed-1:b>this.speed&&(b=this.speed+1),this.paddle.move(b,0)},Ball=function(a,b){this.x=a,this.y=b,this.radius=r.radius,this.x_speed_start=0,this.x_speed=this.x_speed_start,this.y_speed_start=m*t/200,this.y_speed=this.y_speed_start},Ball.prototype.render=function(){f.beginPath(),f.arc(this.x,this.y,this.radius,2*Math.PI,!1),f.fillStyle=r.color,f.fill()},Ball.prototype.reset=function(){this.x=g.x+.5*g.width,this.y=g.y+.25*g.height,this.x_speed=this.x_speed_start,this.y_speed=this.y_speed_start},Ball.prototype.update=function(a,c){this.x+=this.x_speed,this.y+=this.y_speed;var d=this.y-this.radius,e=this.x-this.radius,f=this.x+this.radius,j=this.y+this.radius;e<g.x?(this.x=g.x+this.radius,this.x_speed=-this.x_speed):f>g.x+g.width&&(this.x=g.x+g.width-this.radius,this.x_speed=-this.x_speed),(this.y<g.x||this.y>g.x+g.height)&&(this.y<g.x?h.score++:i.score++,b.pauseGame(),this.reset(),a.restart(),c.restart()),d>.5*g.height?d<a.y+a.height&&j>a.y&&e<a.x+a.width&&f>a.x&&(this.y_speed=-this.y_speed_start,this.x_speed+=a.x_speed/2,this.y+=this.y_speed):d<c.y+c.height&&j>c.y&&e<c.x+c.width&&f>c.x&&(this.y_speed=this.y_speed_start,this.x_speed+=c.x_speed/2,this.y+=this.y_speed)},window.addEventListener("keydown",function(a){d[a.keyCode]=!0}),window.addEventListener("keyup",function(a){delete d[a.keyCode]})};